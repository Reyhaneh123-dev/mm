<!DOCTYPE html>
<html lang="fa" dir="rtl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>آزمایشگاه مجموعه‌ها - نسخه کامل</title>
<style>
body { font-family: 'Vazir', Tahoma, sans-serif; background: #f2f7fb; padding:20px; color:#222; }
.card { background:#fff; padding:20px; border-radius:14px; box-shadow:0 6px 20px rgba(0,0,0,0.05); max-width:800px; margin:auto;}
h1{text-align:center;color:#0077cc;}
label{display:block;margin-top:10px;}
select,input[type=text],button{font-family:inherit;padding:8px;border-radius:6px;border:1px solid #ccc;width:100%;margin-top:6px;box-sizing:border-box;}
button{cursor:pointer;border:none;border-radius:8px;margin-top:12px;font-size:15px;color:#fff;}
button:hover{opacity:0.9;}
#showMath{background:#ff9800;}
#showMembers,#showVenn,#showAxis,#makeSet{background:#0077cc;}
#formulaA,#membersOutput,#vennOutput,#axisOutput{margin-top:10px;padding:10px;border-radius:8px;background:#eef6ff;text-align:center;direction:ltr;}
svg text{font-size:14px;text-anchor:middle;}
</style>
</head>
<body>
<div class="card">
<h1>آزمایشگاه مجموعه‌ها</h1>
<h2>تعریف مجموعه A</h2>
<label>۱. مجموعه A عضو کدام مجموعه شناخته‌شده است؟</label>
<select id="knownSet">
<option value="">-- انتخاب کنید --</option>
<option value="N">اعداد طبیعی (N)</option>
<option value="Z">اعداد صحیح (Z)</option>
<option value="W">اعداد حسابی (W)</option>
<option value="Q">اعداد گویا (Q)</option>
<option value="R">اعداد حقیقی (R)</option>
</select>

<label>۲. شرط به زبان کلامی (در صورت وجود):</label>
<input id="verbal" type="text" placeholder="مثلاً کوچکتر از 5 باشد">

<button id="makeSet">ساخت مجموعه</button>
<button id="showMath">نمایش نماد ریاضی</button>
<button id="showMembers">نمایش اعضا</button>
<button id="showVenn">نمایش نمودار ون</button>
<button id="showAxis">نمایش محور عددی</button>

<div id="formulaA"></div>
<div id="membersOutput"></div>
<div id="vennOutput"></div>
<div id="axisOutput"></div>
</div>

<script>
let setA = [];
let mathFormula = '';

function buildSet() {
    const base = document.getElementById('knownSet').value;
    const verbal = document.getElementById('verbal').value.trim();
    if(!base){ alert('لطفاً مجموعه را انتخاب کنید'); return; }

    // تبدیل شرط کلامی به ریاضی
    let cond='';
    let isInclusive=false;
    if(verbal.includes('کوچکتر یا مساوی')){ cond='x ≤ '+verbal.match(/\d+/)?.[0]; isInclusive=true;}
    else if(verbal.includes('بزرگتر یا مساوی')){ cond='x ≥ '+verbal.match(/\d+/)?.[0]; isInclusive=true;}
    else if(verbal.includes('کوچکتر')){ cond='x < '+verbal.match(/\d+/)?.[0];}
    else if(verbal.includes('بزرگتر')){ cond='x > '+verbal.match(/\d+/)?.[0];}

    mathFormula = `A = { x ∈ ${base}${cond? ' | '+cond:''} }`;
    document.getElementById('formulaA').innerText = '';
    
    // ساخت نمونه مجموعه برای نمایش اعضا
    if(['Q','R'].includes(base)){ setA=[]; }
    else if(base==='N'){ setA=Array.from({length:10},(_,i)=>i+1); }
    else if(base==='W'){ setA=Array.from({length:11},(_,i)=>i); }
    else if(base==='Z'){ setA=Array.from({length:11},(_,i)=>i-5); }

    document.getElementById('membersOutput').innerText='';
    document.getElementById('vennOutput').innerHTML='';
    document.getElementById('axisOutput').innerHTML='';
}

// نمایش نماد ریاضی
document.getElementById('showMath').onclick = () => {
    if(!mathFormula){ alert('ابتدا مجموعه را بسازید'); return; }
    document.getElementById('formulaA').innerText = mathFormula;
}

// نمایش اعضا
document.getElementById('showMembers').onclick = () => {
    const base = document.getElementById('knownSet').value;
    if(['Q','R'].includes(base)){
        document.getElementById('membersOutput').innerText = `به دلیل اینکه مجموعه ${base==='Q'?'گویا':'حقیقی'} است، نمایش اعضا امکان‌پذیر نیست.`;
        return;
    }
    document.getElementById('membersOutput').innerText = `{ ${setA.join(', ')} }`;
}

// نمایش نمودار ون با اعضای مجموعه
document.getElementById('showVenn').onclick = () => {
    const base = document.getElementById('knownSet').value;
    const out = document.getElementById('vennOutput');
    if(['Q','R'].includes(base)){ out.innerText='امکان نمایش نمودار ون وجود ندارد.'; return; }
    const radius = 60; const cx=100; const cy=75;
    let angleStep = 360/setA.length;
    let circles='';
    setA.forEach((v,i)=>{
        let angle = angleStep*i * Math.PI/180;
        let x = cx + radius*Math.cos(angle);
        let y = cy + radius*Math.sin(angle);
        circles += `<text x="${x}" y="${y+5}">${v}</text>`;
    });
    out.innerHTML=`<svg width="200" height="150">
        <circle cx="${cx}" cy="${cy}" r="${radius}" stroke="#0077cc" fill="rgba(0,119,204,0.1)" />
        ${circles}
    </svg>`;
}

// نمایش محور عددی
document.getElementById('showAxis').onclick = () => {
    const base = document.getElementById('knownSet').value;
    const out = document.getElementById('axisOutput');
    if(setA.length===0){
        out.innerText = `نمایش محور برای مجموعه ${base==='Q'?'گویا':'R'} امکان‌پذیر نیست.`;
        return;
    }
    if(['N','W','Z'].includes(base)){
        let first=setA[0], last=setA[setA.length-1];
        let points='';
        setA.forEach(v=>{
            points += `<div style="position:absolute;left:${((v-first)/(last-first))*90}%;top:10px;font-size:12px;">●</div>`;
        });
        out.innerHTML=`<div style="position:relative;height:40px;border-top:2px solid #333;">
            ${points}
        </div>`;
    }
    else if(base==='R'){
        let width=400; let scale=width/10;
        let points='';
        setA.forEach(v=>{
            let x=v*scale; let filled=(Number.isInteger(v))?'●':'○';
            points+=`<div style="position:absolute;left:${x}px;top:10px;font-size:12px;">${filled}</div>`;
        });
        out.innerHTML=`<div style="position:relative;height:40px;width:${width}px;border-top:2px solid #333;">${points}</div>`;
    }
}

document.getElementById('makeSet').onclick = buildSet;
</script>
</body>
</html>
